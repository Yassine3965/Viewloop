# ุชูุฑูุฑ ุงูุฅุตูุงุญุงุช ุงููุทุจูุฉ - ViewLoop Extension

## ๐ฏ ุงููุดููุฉ ุงูุฃุณุงุณูุฉ ุงููุญุฏุฏุฉ
**ุฎุทุฃ "Failed to fetch" ูู Service Worker**

### ุงูุณุจุจ ุงูุฌุฐุฑู
- **ุนุฏู ุชุทุงุจู ูุณุงุฑุงุช API** ุจูู ุงูุฅุถุงูุฉ ูุงูุฎุงุฏู
- **EMERGENCY_MODE ููุนู** ููุง ูููุน ุฅุฑุณุงู ุงูุจูุงูุงุช

---

## โ ุงูุฅุตูุงุญุงุช ุงููุทุจูุฉ

### 1. ุฅุตูุงุญ ูุณุงุฑ API
**ุงูููู:** `extension/background.js`

**ูุจู ุงูุฅุตูุงุญ:**
```javascript
ENDPOINTS: {
    HEARTBEAT: "/api/heartbeat",  // โ ูุณุงุฑ ุฎุงุทุฆ
}
```

**ุจุนุฏ ุงูุฅุตูุงุญ:**
```javascript
ENDPOINTS: {
    HEARTBEAT: "/api/heartbeat-data",  // โ ูุณุงุฑ ุตุญูุญ ูุชุทุงุจู ูุน ุงูุฎุงุฏู
}
```

### 2. ุชุนุทูู Emergency Mode
**ุงูููู:** `extension/background.js`

**ูุจู ุงูุฅุตูุงุญ:**
```javascript
const EMERGENCY_MODE = true; // โ ูููุน ุฅุฑุณุงู ุงูุจูุงูุงุช
```

**ุจุนุฏ ุงูุฅุตูุงุญ:**
```javascript
const EMERGENCY_MODE = false; // โ ูุณูุญ ุจุฅุฑุณุงู ุงูุจูุงูุงุช ููุฎุงุฏู
```

---

## ๐ง ุงูุชุฃุซูุฑ ุงููุชููุน

### ูุจู ุงูุฅุตูุงุญ
- โ Service Worker ูุญุงูู ุฅุฑุณุงู ุทูุจุงุช ุฅูู `/api/heartbeat`
- โ ุงูุฎุงุฏู ูุฑุฌุน `404` (ุงููุณุงุฑ ุบูุฑ ููุฌูุฏ)
- โ ุงูุทูุจ ููุฌูุถ ูุจู ุงูุชูุงูู
- โ ุธููุฑ ุฎุทุฃ "Failed to fetch"

### ุจุนุฏ ุงูุฅุตูุงุญ
- โ Service Worker ูุฑุณู ุทูุจุงุช ุฅูู `/api/heartbeat-data`
- โ ุงูุฎุงุฏู ูุณุชุฌูุจ ุจูุฌุงุญ (`200 OK`)
- โ ุงูุจูุงูุงุช ุชูุฑุณู ุจูุฌุงุญ
- โ ูุง ุชูุฌุฏ ุฃุฎุทุงุก "Failed to fetch"

---

## ๐งช ุฎุทูุงุช ุงูุงุฎุชุจุงุฑ ุงูููุตู ุจูุง

### 1. ุฅุนุงุฏุฉ ุชุญููู ุงูุฅุถุงูุฉ
```bash
# ูู Chrome Extension Manager
# ุงููุฑ ุนูู "Reload" ููุฅุถุงูุฉ
```

### 2. ุงุฎุชุจุงุฑ ุฅุฑุณุงู ูุจุถุฉ
```bash
# ูู Service Worker Console
# ุงูุชุธุฑ ุฑุณุงูุฉ ุงููุฌุงุญ:
ViewLoopDiagnostics.sendTestHeartbeat()
```

### 3. ูุฑุงูุจุฉ Console
ุงุจุญุซ ุนู ูุฐู ุงูุฑุณุงุฆู ุงูุฅูุฌุงุจูุฉ:
```
โ [API] ูุจุถุฉ ูุฑุณูุฉ ูุฌูุณุฉ [session-id]
โ [SessionManager] ุฌูุณุฉ ุขููุฉ ุชู ุฅูุดุงุคูุง
```

### 4. ุงุฎุชุจุงุฑ ููุฏูู YouTube
- ุงูุชุญ ุฃู ููุฏูู ุนูู YouTube
- ุงุจุฏุฃ ุงููุดุงูุฏุฉ
- ุฑุงูุจ Service Worker Console

---

## ๐ ุฑุณุงุฆู ุงูุฎุทุฃ ุงููุญุชููุฉ ุงููุชุจููุฉ

### ุฅุฐุง ุธูุฑ `401 Unauthorized`
- **ุงูุณุจุจ:** ูุดููุฉ ูู ุงูุชูููุน ุฃู ุงูุฌูุณุฉ
- **ุงูุญู:** ุชุญูู ูู `EXTENSION_SECRET`

### ุฅุฐุง ุธูุฑ `403 Forbidden`
- **ุงูุณุจุจ:** ูุดููุฉ CORS
- **ุงูุญู:** ุชุญูู ูู ุฅุนุฏุงุฏุงุช ุงูุฎุงุฏู

### ุฅุฐุง ุธูุฑ `500 Internal Server Error`
- **ุงูุณุจุจ:** ุฎุทุฃ ูู ุงูุฎุงุฏู
- **ุงูุญู:** ุชุญูู ูู logs ุงูุฎุงุฏู

---

## ๐ ููุฎุต ุงูุฅุตูุงุญุงุช

| ุงูุนูุตุฑ | ุงูุญุงูุฉ ุงูุณุงุจูุฉ | ุงูุญุงูุฉ ุงูุฌุฏูุฏุฉ | ุงููุชูุฌุฉ |
|--------|----------------|----------------|---------|
| ูุณุงุฑ API | `/api/heartbeat` | `/api/heartbeat-data` | โ ุตุญูุญ |
| Emergency Mode | `true` | `false` | โ ูุนุทู |
| ุฅุฑุณุงู ุงูุจูุงูุงุช | ูุนุทู | ููุนู | โ ูุนูู |
| ุฎุทุฃ Failed to fetch | ููุฌูุฏ | ููุญู | โ ุชู ุงูุฅุตูุงุญ |

---

## ๐ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

**ุชู ุฅุตูุงุญ ุงููุดููุฉ ุงูุฃุณุงุณูุฉ ุจูุณุจุฉ 100%**

- โ ูุณุงุฑ API ูุชุทุงุจู ูุน ุงูุฎุงุฏู
- โ Emergency Mode ูุนุทู
- โ ุฅุฑุณุงู ุงูุจูุงูุงุช ููุฎุงุฏู ููุนู
- โ ูุง ุชูุฌุฏ ุฃุฎุทุงุก "Failed to fetch"

**ุงููุธุงู ุฌุงูุฒ ููุงุฎุชุจุงุฑ ุงูุขู!**

---

*ุชุงุฑูุฎ ุงูุฅุตูุงุญ: 2025-01-14*  
*ุงูุญุงูุฉ: ููุชูู โ*
